<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.quan.core.rabbitmq.unit.dao.UnitDao">

    <!-- 通用查询映射结果  -->
    <resultMap type="com.quan.core.rabbitmq.unit.model.Unit" id="BaseResultMap">
        <result property="id" column="id"/>
        <result property="parentId" column="parent_id"/>
        <result property="name" column="name"/>
        <result property="aliasName" column="alias_name"/>
        <result property="unitCode" column="unit_code"/>
        <result property="note" column="note"/>
        <result property="field1" column="field1"/>
        <result property="field2" column="field2"/>
        <result property="field3" column="field3"/>
        <result property="sort" column="sort"/>
        <result property="disabled" column="disabled"/>
        <result property="hasChildren" column="has_children"/>
        <result property="logo" column="logo"/>
        <result property="createTime" column="create_time"/>
        <result property="createUserId" column="create_user_id"/>
        <result property="updateTime" column="update_time"/>
        <result property="updateUserId" column="update_user_id"/>
        <result property="dataState" column="data_state"/>
    </resultMap>

    <sql id="baseColumnList">
        id as id,
        parent_id as parentId,
        `name` as name,
        alias_name as aliasName,
        note as note,
        field1 as field1,
        field2 as field2,
        field3 as field3,
        disabled as disabled
    </sql>


    <sql id="where">
        <where>
            dataState = 0
            <if test="data.id != null">
                id = #{data.id},
            </if>
            <if test="data.parent_id != null">
                parent_id = #{data.parent_id},
            </if>
            <if test="data.name != null">
                name = #{data.name},
            </if>
            <if test="data.alias_name != null">
                alias_name = #{data.alias_name},
            </if>
            <if test="data.unit_code != null">
                unit_code = #{data.unit_code},
            </if>
            <if test="data.note != null">
                note = #{data.note},
            </if>
            <if test="data.field1 != null">
                field1 = #{data.field1},
            </if>
            <if test="data.field2 != null">
                field2 = #{data.field2},
            </if>
            <if test="data.field3 != null">
                field3 = #{data.field3},
            </if>
            <if test="data.sort != null">
                sort = #{data.sort},
            </if>
            <if test="data.disabled != null">
                disabled = #{data.disabled},
            </if>
            <if test="data.has_children != null">
                has_children = #{data.has_children},
            </if>
            <if test="data.logo != null">
                logo = #{data.logo},
            </if>
            <if test="data.create_time != null">
                create_time = #{data.create_time},
            </if>
            <if test="data.create_user_id != null">
                create_user_id = #{data.create_user_id},
            </if>
            <if test="data.update_time != null">
                update_time = #{data.update_time},
            </if>
            <if test="data.update_user_id != null">
                update_user_id = #{data.update_user_id},
            </if>
            <if test="data.data_state != null">
                data_state = #{data.data_state},
            </if>
        </where>
    </sql>


    <insert id="save">
        insert into sys_unit(
                                id,
                                        parent_id,
                                        `name`,
                                        alias_name,
                                        unit_code,
                                        note,
                                        field1,
                                        field2,
                                        field3,
                                        sort,
                                        disabled,
                                        has_children,
                                        logo,
                                        create_time,
                                        create_user_id,
                                        data_state
                    ) values (
                                #{ id},
                                       #{ parent_id},
                                       #{ name},
                                       #{ alias_name},
                                       #{ unit_code},
                                       #{ note},
                                       #{ field1},
                                       #{ field2},
                                       #{ field3},
                                       #{ sort},
                                       #{ disabled},
                                       #{ has_children},
                                       #{ logo},
                                       #{ create_time},
                                       #{ create_user_id},
                                       #{ data_state}
                        )
        </insert>


    <insert id="batchSave">
        insert into sys_unit(
        id,
        parent_id,
        `name`,
        alias_name,
        unit_code,
        note,
        field1,
        field2,
        field3,
        sort,
        disabled,
        has_children,
        logo,
        create_time,
        create_user_id,
        update_time,
        update_user_id,
        data_state
        ) values
        <foreach collection="java.util.List" item="item" index="index" separator=",">
            (
            #{item.id},
            #{item.parent_id},
            #{item.name},
            #{item.alias_name},
            #{item.unit_code},
            #{item.note},
            #{item.field1},
            #{item.field2},
            #{item.field3},
            #{item.sort},
            #{item.disabled},
            #{item.has_children},
            #{item.logo},
            #{item.create_time},
            #{item.create_user_id},
            #{item.update_time},
            #{item.update_user_id},
            #{item.data_state}
            )
        </foreach>

    </insert>


    <update id="update">
        UPDATE sys_unit
        <set>
            <if test="id != null">
                id = #{id},
            </if>
            <if test="parent_id != null">
                parent_id = #{parent_id},
            </if>
            <if test="name != null">
                `name` = #{name},
            </if>
        </set>
        WHERE dataState = 0 AND id = #{id}
    </update>


    <delete id="delete" parameterType="java.lang.Long" flushCache="true">
        UPDATE sys_unit SET dataState = 2 WHERE dataState = 0 AND id = #{id}
    </delete>


    <delete id="batchDelete" parameterType="java.util.List" flushCache="true">

        UPDATE sys_unit SET dataState = 2
        WHERE dataState = 0 AND id IN
        <foreach collection="ids" index="index" item="id" separator="," open="(" close=")">
            #{id}
        </foreach>
    </delete>


    <select id="findOneById" parameterType="java.lang.Long" resultType="com.quan.core.rabbitmq.unit.model.Unit">
        SELECT
        <include refid="baseColumnList"/>
        FROM sys_unit
        WHERE dataState = 0 AND id = #{id}
    </select>


    <select id="findOneByCnd" parameterType="java.lang.Long" resultType="com.quan.core.rabbitmq.unit.model.Unit">
        SELECT
        <include refid="baseColumnList"/>
        FROM sys_unit
        <include refid="where"/>
    </select>


    <select id="findAll" resultType="com.quan.core.rabbitmq.unit.model.Unit">
        SELECT
        <include refid="baseColumnList"/>
        FROM sys_unit t
        <include refid="where"/>
    </select>


    <select id="list" resultType="com.quan.core.rabbitmq.unit.model.Unit">
        SELECT
        <include refid="baseColumnList"/>
        FROM sys_unit t
        <include refid="where"/>
    </select>


</mapper>